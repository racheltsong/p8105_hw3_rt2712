---
title: "Untitled"
author: "Rachel Tsong"
date: "October 14, 2018"
output: html_document
---

```{r fig.width = 10, fig.height = 10}
library(tidyverse)
library(p8105.datasets)
data("instacart")

instacart %>% 
  group_by(aisle) %>%
  summarize(n = n()) %>%
  arrange(-n) %>%
  head() %>%
  knitr::kable()

instacart %>%
  group_by(department, aisle, aisle_id) %>%
  filter(aisle != "missing") %>%
  summarize(n = n()) %>%
  ungroup() %>%
  mutate(aisle = factor(aisle, levels = aisle[order(n)])) %>%
  ggplot(aes(x = aisle, y = n, color = department, fill = department)) +
  geom_bar(stat = "identity", width = 0.5) + 
  coord_flip() +
  theme(axis.text.y = element_text(size = rel(0.6)), legend.position = "bottom" ) +
  labs(x = "Number of Orders", y = "Aisle", title = "Number of Orders on Instacart by Aisle")
 
```
